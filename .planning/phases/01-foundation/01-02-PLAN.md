---
phase: 01-foundation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - modules/02-structured-output/README.md
  - modules/02-structured-output/demonstration.md
  - modules/02-structured-output/exercise.md
  - modules/02-structured-output/schema-examples/recipe-schema.json
  - modules/02-structured-output/schema-examples/product-schema.json
  - modules/02-structured-output/solutions/solution.md
autonomous: true

must_haves:
  truths:
    - "Demonstration shows JSON Schema defining output structure"
    - "Participants can create a schema and get valid JSON from Gemini"
    - "Exercise includes schema validation and testing"
    - "Solutions show both simple and complex schema examples"
  artifacts:
    - path: "modules/02-structured-output/README.md"
      provides: "Module overview for structured output"
      min_lines: 20
    - path: "modules/02-structured-output/demonstration.md"
      provides: "Schema creation and usage demonstration"
      min_lines: 40
    - path: "modules/02-structured-output/schema-examples/recipe-schema.json"
      provides: "Working recipe schema example"
      contains: "response_json_schema"
    - path: "modules/02-structured-output/solutions/solution.md"
      provides: "Complete solution with schema and prompt"
      min_lines: 30
  key_links:
    - from: "modules/02-structured-output/exercise.md"
      to: "schema-examples/"
      via: "references example schemas"
      pattern: "schema-examples/"
    - from: "modules/02-structured-output/demonstration.md"
      to: "AI Studio Run settings"
      via: "configuration instructions"
      pattern: "Run settings.*JSON mode"
---

<objective>
Create Module 02: Structured Output - teaching participants how to get reliable JSON responses from Gemini using JSON Schema.

Purpose: This module solves a critical real-world problem: getting structured, parseable data from LLMs. It demonstrates Gemini's native structured output capability (not prompt hacking) and sets up patterns used in later modules.

Output: Complete module with schema examples, demonstration showing AI Studio's JSON mode, hands-on exercise creating custom schemas, and solutions.
</objective>

<execution_context>
@/home/ahsan/.claude/get-shit-done/workflows/execute-plan.md
@/home/ahsan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@/home/ahsan/projects/code-at-speed-of-thought/.planning/PROJECT.md
@/home/ahsan/projects/code-at-speed-of-thought/.planning/ROADMAP.md
@/home/ahsan/projects/code-at-speed-of-thought/.planning/STATE.md
@/home/ahsan/projects/code-at-speed-of-thought/.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Create Module 02 structure, README, and JSON Schema examples</name>
  <files>
    modules/02-structured-output/README.md
    modules/02-structured-output/schema-examples/recipe-schema.json
    modules/02-structured-output/schema-examples/product-schema.json
    modules/02-structured-output/solutions/.gitkeep
  </files>
  <action>
Create the module directory structure, README, and two example JSON schemas following patterns from RESEARCH.md.

**README.md content:**
- Module title: "Module 02: Structured Output"
- Duration: 20 minutes
- Learning Objectives:
  * Understand why structured output matters for real applications
  * Create JSON Schema to define output format
  * Use AI Studio's JSON mode to guarantee valid JSON responses
  * Recognize the importance of description fields in schemas
- Prerequisites:
  * Completion of Module 01 (AI Studio basics)
  * Basic understanding of JSON format
- Overview explaining the problem (unreliable text parsing) and solution (native structured output)
- Reference to demonstration.md, exercise.md, and schema-examples/

**schema-examples/recipe-schema.json content:**
Use the exact schema from RESEARCH.md code examples section (Structured Output with JSON Schema), which includes:
- Type: object
- Properties: recipe_name (string), ingredients (array of objects), steps (array of strings)
- Required fields: recipe_name, ingredients, steps
- Descriptions on all fields (critical for model guidance)

**schema-examples/product-schema.json content:**
Create a product analysis schema:
```json
{
  "type": "object",
  "properties": {
    "product_name": {
      "type": "string",
      "description": "The name of the product"
    },
    "category": {
      "type": "string",
      "description": "Product category (electronics, clothing, food, etc.)"
    },
    "price_estimate": {
      "type": "number",
      "description": "Estimated price in USD"
    },
    "features": {
      "type": "array",
      "description": "List of key product features",
      "items": {
        "type": "string"
      }
    },
    "target_audience": {
      "type": "string",
      "description": "Who this product is designed for"
    }
  },
  "required": ["product_name", "category", "price_estimate", "features"]
}
```

Format both schemas with proper indentation and include a comment at the top explaining their purpose.
  </action>
  <verify>
Verify all files exist and contain required content:

```bash
ls -R modules/02-structured-output/
```
Expected: README.md, demonstration.md (will be created in next task), schema-examples/recipe-schema.json, schema-examples/product-schema.json

Verify schema validity:
```bash
cat modules/02-structured-output/schema-examples/recipe-schema.json | grep -E "(type|properties|description|required)" | wc -l
```
Expected: At least 8 matches (multiple fields with these keywords)

Verify README has learning objectives:
```bash
cat modules/02-structured-output/README.md | grep -i "learning objectives" -A 5 | wc -l
```
Expected: At least 4 lines
  </verify>
  <done>
Module 02 structure exists with README containing learning objectives, two example JSON schemas (recipe and product) with proper descriptions, and directory ready for demonstration and exercise files.
  </done>
</task>

<task type="auto">
  <name>Create demonstration showing AI Studio JSON mode configuration</name>
  <files>modules/02-structured-output/demonstration.md</files>
  <action>
Create the instructor demonstration guide showing AI Studio's native JSON mode feature, emphasizing this is NOT prompt hacking.

**Content structure (5-7 minute demonstration):**

**Introduction (1 minute):**
- The problem: Getting reliable structured data from text-based LLM responses
- The old way: Prompting "return JSON" and hoping (unreliable)
- The new way: Gemini's native structured output with schema enforcement

**Step-by-step demonstration (5-6 minutes):**

1. **Open AI Studio and create new prompt**
   - Action: Navigate to aistudio.google.com, click "New prompt"
   - Expected result: Prompt editor opens

2. **Write a prompt (without JSON instructions)**
   - Action: Enter prompt: "Analyze this product: iPhone 15 Pro"
   - Note: Do NOT ask for JSON in the prompt
   - Action: Click "Run"
   - Expected result: Text response (paragraphs, not JSON)
   - Point out: This is natural but not parseable

3. **Enable JSON mode**
   - Action: Click "Run settings" (gear icon in top right)
   - Expected result: Settings panel opens
   - Action: Under "Response format", select "JSON mode"
   - Expected result: Schema editor appears
   - [Screenshot: Run settings panel with JSON mode selected]

4. **Load example schema**
   - Action: Copy contents of `schema-examples/product-schema.json`
   - Action: Paste into schema editor
   - Expected result: Schema validates (green checkmark or no errors)
   - Point out: Description fields are instructions to the model

5. **Run with schema enforcement**
   - Action: Click "Run" (same prompt as before)
   - Expected result: Valid JSON matching the schema structure
   - Point out:
     * No "return as JSON" in prompt needed
     * Schema guarantees structure
     * Model uses descriptions to populate fields correctly
   - [Screenshot: JSON response matching schema]

6. **Show the API code**
   - Action: Click "Get code"
   - Expected result: Code includes `response_mime_type` and `response_json_schema` config
   - Show: How this translates to Python code (reference RESEARCH.md example)
   - Explain: This is how you'd use it in production

**Key talking points:**
- **Enforcement vs prompting:** Schema is enforced by Gemini, not hoped for
- **Description fields matter:** They guide the model on what to put in each field
- **Valid structure ≠ correct content:** Schema ensures JSON is valid, not that values are accurate
- **API equivalence:** Everything in UI has an API equivalent

**Common pitfall to demonstrate:**
- Bad schema (no descriptions): Show schema without description fields
- Result: Valid JSON but potentially wrong/generic values
- Fix: Add descriptions, re-run, show improvement
  </action>
  <verify>
Verify demonstration.md exists and contains:
- Introduction explaining the problem/solution
- 6 numbered steps with Action/Expected result pairs
- At least 2 screenshot placeholders
- Key talking points section
- Common pitfall demonstration

```bash
cat modules/02-structured-output/demonstration.md | grep -E "(Action:|Expected result:|Screenshot:|Key talking points)" | wc -l
```
Expected: At least 18 matches
  </verify>
  <done>
Demonstration guide exists with complete walkthrough of AI Studio JSON mode, schema configuration, before/after comparison, and emphasis on schema descriptions as model instructions (not just validation).
  </done>
</task>

<task type="auto">
  <name>Create hands-on exercise with schema creation challenge</name>
  <files>
    modules/02-structured-output/exercise.md
    modules/02-structured-output/solutions/solution.md
  </files>
  <action>
Create the hands-on exercise where participants create their own schema and test it.

**exercise.md content (10-13 minutes):**

**Your Task:**
Create a JSON Schema for a specific use case and use it to get structured output from Gemini.

**Setup (1 minute):**
1. Open aistudio.google.com
2. Create a new prompt
3. Open Run settings → JSON mode

**Option A: Guided Challenge (For beginners)**

**Challenge:** Create a schema for analyzing customer feedback

Step 1: Define your schema (4 minutes)
- Open a text editor or use the AI Studio schema editor
- Create a schema with these fields:
  * `sentiment` (string): positive, negative, or neutral
  * `topic` (string): what the feedback is about
  * `confidence_score` (number): 0-100, how confident the analysis is
  * `action_required` (boolean): whether follow-up action is needed
- Add description fields to guide the model
- Mark required fields

Reference: Look at `schema-examples/product-schema.json` for structure

Step 2: Test your schema (4 minutes)
- Paste schema into AI Studio JSON mode
- Prompt: "Analyze this customer feedback: 'The new dashboard is confusing but the support team was helpful'"
- Click Run
- Verify: Response is valid JSON matching your schema

Step 3: Iterate (3 minutes)
- Try different feedback examples
- Adjust descriptions if results don't match expectations
- Test edge cases (very short feedback, mixed sentiment)

**Option B: Independent Challenge (For advanced users)**

Goal: Create a schema for a use case relevant to your work, test it with multiple examples, and verify schema enforcement.

Use case ideas:
- Code review analysis (quality score, issues found, suggestions)
- Meeting notes summary (action items, participants, decisions)
- Social media post analysis (sentiment, engagement prediction, hashtags)

Requirements:
- At least 4 fields with proper types
- All fields have descriptive descriptions
- Test with 3 different inputs
- Handle edge cases

Solution: See `solutions/solution.md` for reference

**For Fast Finishers: Going Further**

Advanced challenges:
- Create nested objects in your schema (e.g., array of objects with properties)
- Add `enum` constraints (e.g., sentiment must be "positive", "negative", or "neutral")
- Test what happens when you remove description fields (observe quality degradation)
- Export the API code and identify how schema is passed

**Success Criteria:**
- [ ] You have created a valid JSON Schema
- [ ] Schema includes description fields on all properties
- [ ] You have tested the schema with at least 2 different prompts
- [ ] You understand that schema enforces structure, not accuracy
- [ ] You can explain why description fields matter

Duration: ⏱️ Expected: 12 minutes | Buffer: 3 minutes

**solutions/solution.md content:**

# Module 02 Solution

## Customer Feedback Analysis Schema

```json
{
  "type": "object",
  "properties": {
    "sentiment": {
      "type": "string",
      "description": "Overall sentiment: positive, negative, or neutral",
      "enum": ["positive", "negative", "neutral"]
    },
    "topic": {
      "type": "string",
      "description": "Main subject of the feedback (e.g., product, support, pricing)"
    },
    "confidence_score": {
      "type": "number",
      "description": "Confidence in this analysis from 0-100, where 100 is highest confidence",
      "minimum": 0,
      "maximum": 100
    },
    "action_required": {
      "type": "boolean",
      "description": "Whether this feedback requires immediate follow-up action"
    },
    "summary": {
      "type": "string",
      "description": "One-sentence summary of the feedback"
    }
  },
  "required": ["sentiment", "topic", "confidence_score", "action_required"]
}
```

## Example Prompt

```
Analyze this customer feedback: "The new dashboard is confusing but the support team was helpful"
```

## Expected Response

```json
{
  "sentiment": "neutral",
  "topic": "product and support",
  "confidence_score": 85,
  "action_required": true,
  "summary": "Mixed feedback about dashboard usability with positive support experience"
}
```

## API Code (Python)

```python
from google import genai
from google.genai import types

client = genai.Client(api_key="YOUR_API_KEY")

feedback_schema = {
  "type": "object",
  "properties": {
    "sentiment": {
      "type": "string",
      "description": "Overall sentiment: positive, negative, or neutral",
      "enum": ["positive", "negative", "neutral"]
    },
    "topic": {
      "type": "string",
      "description": "Main subject of the feedback"
    },
    "confidence_score": {
      "type": "number",
      "description": "Confidence in this analysis from 0-100",
      "minimum": 0,
      "maximum": 100
    },
    "action_required": {
      "type": "boolean",
      "description": "Whether this feedback requires immediate follow-up"
    }
  },
  "required": ["sentiment", "topic", "confidence_score", "action_required"]
}

config = types.GenerateContentConfig(
    response_mime_type="application/json",
    response_json_schema=feedback_schema
)

response = client.models.generate_content(
    model="gemini-3-flash-preview",
    contents="Analyze this customer feedback: 'The new dashboard is confusing but the support team was helpful'",
    config=config
)

import json
result = json.loads(response.text)
print(json.dumps(result, indent=2))
```

## Key Learnings

- **description fields are critical:** They instruct the model on what to populate, not just validate structure
- **Schema enforcement is guaranteed:** Response will always match schema structure
- **Structure ≠ Accuracy:** Schema ensures valid JSON but doesn't guarantee correct analysis
- **Iterative refinement:** Adjust descriptions based on results
- **Advanced features:** enum, minimum, maximum add additional constraints

## Common Issues

**Issue:** Schema validation error in AI Studio
**Solution:** Check for missing commas, quotes, or brackets. Use a JSON validator.

**Issue:** Response has generic/wrong values despite valid structure
**Solution:** Improve description fields with more specific guidance

**Issue:** "type" field shows unexpected values
**Solution:** Use enum constraint to limit allowed values

**Example of bad schema (no descriptions):**
```json
{
  "type": "object",
  "properties": {
    "sentiment": {"type": "string"},
    "topic": {"type": "string"}
  }
}
```
Result: Valid JSON but model guesses what to populate

**Example of good schema (with descriptions):**
```json
{
  "type": "object",
  "properties": {
    "sentiment": {
      "type": "string",
      "description": "Overall sentiment: positive, negative, or neutral"
    },
    "topic": {
      "type": "string",
      "description": "Main subject of the feedback"
    }
  }
}
```
Result: Valid JSON with accurate field population
  </action>
  <verify>
Verify both files exist and contain required sections:

```bash
cat modules/02-structured-output/exercise.md | grep -E "(Option A:|Option B:|Success Criteria:|Step [0-9]:)" | wc -l
```
Expected: At least 5 matches

```bash
cat modules/02-structured-output/solutions/solution.md | grep -E "(Schema|Example|API Code|Key Learnings|Common Issues)" | wc -l
```
Expected: At least 5 matches

Verify solution includes valid JSON:
```bash
cat modules/02-structured-output/solutions/solution.md | grep -o '"type": "object"' | wc -l
```
Expected: At least 2 (schema appears in solution and common issues section)
  </verify>
  <done>
Exercise file exists with guided schema creation challenge (customer feedback analysis), independent option for custom use cases, and Going Further section. Solution includes complete schema with descriptions, API code, key learnings emphasizing description importance, and common issues with before/after examples.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Verify directory structure:
   ```bash
   ls -R modules/02-structured-output/
   ```
   Expected: README.md, demonstration.md, exercise.md, schema-examples/recipe-schema.json, schema-examples/product-schema.json, solutions/solution.md

2. Verify schema validity:
   ```bash
   cat modules/02-structured-output/schema-examples/*.json | python3 -m json.tool > /dev/null && echo "Valid JSON"
   ```
   Expected: "Valid JSON" output

3. Verify content completeness:
   ```bash
   wc -l modules/02-structured-output/demonstration.md modules/02-structured-output/exercise.md
   ```
   Expected: demonstration ~60 lines, exercise ~90 lines

4. Verify key concepts are covered:
   ```bash
   grep -ri "description" modules/02-structured-output/ | wc -l
   ```
   Expected: At least 20 mentions (critical concept throughout module)
</verification>

<success_criteria>
Module 02 is complete when:
- [ ] All module files exist with proper structure
- [ ] Two example schemas exist (recipe and product) with descriptions
- [ ] Demonstration shows AI Studio JSON mode configuration
- [ ] Exercise includes schema creation for customer feedback analysis
- [ ] Solutions include complete schema, API code, and common issues
- [ ] Description fields are emphasized as model instructions (not just validation)
- [ ] Content differentiates schema enforcement from prompt hacking
- [ ] Mixed skill levels supported via Option A/B structure
- [ ] Duration fits 20-minute target
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-02-SUMMARY.md`
</output>
